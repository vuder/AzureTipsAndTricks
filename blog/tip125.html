<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tip 125 - Using Azure Function to call our Logic App with the IoT Button | Azure Tips and Tricks</title>
    <meta name="description" content="">
    <link rel="apple-touch-icon" sizes="57x57" href="/AzureTipsAndTricks/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/AzureTipsAndTricks/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/AzureTipsAndTricks/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/AzureTipsAndTricks/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/AzureTipsAndTricks/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/AzureTipsAndTricks/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/AzureTipsAndTricks/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/AzureTipsAndTricks/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/AzureTipsAndTricks/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/AzureTipsAndTricks/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/AzureTipsAndTricks/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/AzureTipsAndTricks/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/AzureTipsAndTricks/favicon-16x16.png">
  <link rel="manifest" href="/AzureTipsAndTricks/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <script async="true" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    
    <link rel="preload" href="/AzureTipsAndTricks/assets/css/0.styles.9e4235cc.css" as="style"><link rel="preload" href="/AzureTipsAndTricks/assets/js/app.c3e71ca2.js" as="script"><link rel="preload" href="/AzureTipsAndTricks/assets/js/4.1e17da4f.js" as="script"><link rel="preload" href="/AzureTipsAndTricks/assets/js/36.3c05d0f1.js" as="script"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/10.8626c325.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/100.c911c2a4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/101.d1cf8a26.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/102.479c7c5d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/103.1274c986.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/104.8d67aaba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/105.1c388ee4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/106.ba29a28e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/107.cca0d31c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/108.098cd884.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/109.de1ca92d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/11.73c99a97.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/110.9efbd62b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/111.eae6586f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/112.b455051b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/113.4c0499dd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/114.ba69c74a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/115.6f7c5113.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/116.cb9c5f6e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/117.c3b9daba.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/118.99356ebd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/119.93fd2754.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/12.75e82287.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/120.52009b4c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/121.6aa465d4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/122.a658874c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/123.74b777e0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/124.d6ef81c9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/125.019e64e4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/126.cc447e4a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/127.612ac31f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/128.99eff053.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/129.0113fb72.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/13.2107c91c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/130.b6a7bf75.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/131.929eefcb.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/132.2d38ae8a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/133.6a9a983a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/134.8e0db27f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/135.59ba26c6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/136.c13695be.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/137.d8732981.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/138.be88ccb8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/139.2bf90d86.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/14.3bc22c5f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/140.9304768e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/141.2131c606.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/142.547dfd45.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/143.b548066b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/144.6481321c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/145.e403c856.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/146.a89a0ddf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/147.151fb2f9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/148.5ddbdee0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/149.b47bd2d4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/15.5c1178ab.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/150.62d81cc6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/151.08ed51f5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/152.957dd5fd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/153.e692cc80.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/154.930c2821.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/155.b6f8b445.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/156.8acf8981.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/157.3a53753a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/158.c4ef2996.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/159.b0283a9c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/16.0b17ece3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/160.77918f4b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/161.ef4c906d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/162.a1c6ee6a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/163.1fde661e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/164.1c539b80.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/165.8baf6937.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/166.d59eadd2.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/167.74215923.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/168.07c92979.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/169.435e803b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/17.f1751be4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/170.daf27cd5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/171.0e7ac3a6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/172.124121c2.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/173.be9074c6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/174.c6ede7e5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/175.5997519c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/176.dfec8d77.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/177.2a332a52.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/178.ebd20069.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/179.31d4057f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/18.3131838d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/180.cee6c424.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/181.0ee02d59.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/182.9603979d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/183.565b2ca0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/184.7fcbb2dd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/185.7d6a0c10.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/186.e7a29c09.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/187.b3bbd94d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/188.abc61b58.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/189.f0784ac3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/19.fd19baa6.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/190.305e4970.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/191.b4c1c444.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/192.32518e78.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/193.34ebcf85.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/194.db58e5cf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/195.9e3a22a9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/196.ea3bd788.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/197.d0f3a378.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/198.7402b0dc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/199.7160d8b0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/20.b53e2000.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/200.00e03493.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/201.810cb54d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/202.df536126.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/203.264d0519.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/204.0ed73b77.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/205.5572e437.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/206.a699c406.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/207.f96ef54c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/208.acf031cf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/21.eb13dd9a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/22.f0779215.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/23.93c6b265.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/24.612fc524.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/25.64a4ffd5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/26.17442306.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/27.20d0da03.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/28.f2127593.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/29.e376683a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/3.5ca0f648.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/30.3fc9ebb1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/31.b9c51223.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/32.8c144ef1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/33.b38a1922.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/34.c6839324.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/35.136a881a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/37.4771eef8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/38.f4d4212e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/39.244af985.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/40.5a96f55d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/41.94037173.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/42.f4008434.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/43.a7d8a677.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/44.d6173d37.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/45.f13d0f5a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/46.8587183b.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/47.4a702d2a.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/48.a58d773c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/49.6521472c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/5.b32c499c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/50.35f57715.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/51.8d8d17e8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/52.d65435bc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/53.46207ab5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/54.915dfa26.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/55.7ed05ed5.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/56.f51f84d9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/57.32109f3e.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/58.62dafcdc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/59.52449aa8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/6.c702ed47.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/60.0262b5cd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/61.2c464a00.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/62.f01b5920.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/63.f5f1b18c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/64.2cf41ea0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/65.94228372.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/66.c5a352cf.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/67.bb201c13.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/68.ebfa2ed1.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/69.40253b82.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/7.ee00b141.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/70.b0176c44.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/71.a6fe10e2.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/72.7df66d68.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/73.b63d0534.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/74.4d106db0.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/75.7f0b2420.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/76.339c5472.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/77.d1b1bd2c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/78.11e42d9d.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/79.4c49acfd.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/8.f786c0ca.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/80.09ea13d3.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/81.1015cc9c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/82.ee698342.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/83.95ae3bad.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/84.ebef5dd8.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/85.4a8b1607.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/86.e98942af.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/87.769e475f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/88.da928376.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/89.1aa9e747.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/9.7421982f.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/90.a5afef77.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/91.b3126869.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/92.2e1859a4.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/93.3f069468.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/94.e68ea7cc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/95.2df3ecbc.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/96.486b19d9.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/97.99cb753c.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/98.d411c758.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/99.bf0a5783.js"><link rel="prefetch" href="/AzureTipsAndTricks/assets/js/vendors~docsearch.9a8918f9.js">
    <link rel="stylesheet" href="/AzureTipsAndTricks/assets/css/0.styles.9e4235cc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/AzureTipsAndTricks/" class="home-link router-link-active"><img src="/AzureTipsAndTricks/files/vintage.png" alt="Azure Tips and Tricks" class="logo"> <span class="site-name can-hide">Azure Tips and Tricks</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/AzureTipsAndTricks/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://videos.azuredev.tips" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Videos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/AzureTipsAndTricks/#site-map" class="nav-link">eBooks</a></div><div class="nav-item"><a href="https://github.com/Microsoft/AzureTipsAndTricks/issues/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Questions?
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/rss.xml" class="nav-link">
  RSS Feed
</a></div> <a href="https://github.com/microsoft/azuretipsandtricks" target="_blank" rel="noopener noreferrer" class="repo-link">
    Star this Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/AzureTipsAndTricks/" class="nav-link">Home</a></div><div class="nav-item"><a href="http://videos.azuredev.tips" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Videos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/AzureTipsAndTricks/#site-map" class="nav-link">eBooks</a></div><div class="nav-item"><a href="https://github.com/Microsoft/AzureTipsAndTricks/issues/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Questions?
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://microsoft.github.io/AzureTipsAndTricks/rss.xml" class="nav-link">
  RSS Feed
</a></div> <a href="https://github.com/microsoft/azuretipsandtricks" target="_blank" rel="noopener noreferrer" class="repo-link">
    Star this Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Home</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/AzureTipsAndTricks/" class="sidebar-link">Welcome</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Tips</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Recently Added</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>App Service</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>APIM</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Authentication</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>AzCopy</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CDN</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CLI</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cloud Shell</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cognitive Services</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Containers</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Cosmos DB</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>DevOps</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Front Door</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Functions</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HD Insight</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>iOS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>IoT</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/AzureTipsAndTricks/blog/tip96.html" class="sidebar-link">Tip 96 - Getting up and started with Azure IoT MXChip</a></li><li><a href="/AzureTipsAndTricks/blog/tip114.html" class="sidebar-link">Tip 114 - Send JSON to Azure IoT Hub with C#</a></li><li><a href="/AzureTipsAndTricks/blog/tip122.html" class="sidebar-link">Tip 122 - Creating an IoT Hub for the IoT Button</a></li><li><a href="/AzureTipsAndTricks/blog/tip123.html" class="sidebar-link">Tip 123 - Configuring and Setting up the IoT Button</a></li><li><a href="/AzureTipsAndTricks/blog/tip124.html" class="sidebar-link">Tip 124 - Creating the Azure Logic App for our IoT Button</a></li><li><a href="/AzureTipsAndTricks/blog/tip125.html" class="active sidebar-link">Tip 125 - Using Azure Function to call our Logic App with the IoT Button</a></li><li><a href="/AzureTipsAndTricks/blog/tip126.html" class="sidebar-link">Tip 126 - Getting Started with Azure IoT Central</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Key Vault</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Logic Apps</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Machine Learning</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Media Services</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Monitor</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Portal</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>PowerShell</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Productivity</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SAP</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SDKs</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SendGrid</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SignalR</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>SQL</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Storage</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Virtual Machines</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>VNET</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page" data-v-0e4468e2> <div class="content default" data-v-0e4468e2><div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>💡 Learn more : <a href="https://docs.microsoft.com/azure/iot-hub/about-iot-hub?WT.mc_id=docs-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Azure IoT Hub Overview<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <h4 id="special-thanks"><a href="#special-thanks" aria-hidden="true" class="header-anchor">#</a> Special Thanks</h4> <p>Special Thanks to <a href="http://twitter.com/StefanWickDev?WT.mc_id=twitter-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">Stefan Wick<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on the Azure IoT Team for his review and edits on this post.</p> <h4 id="the-series-so-far"><a href="#the-series-so-far" aria-hidden="true" class="header-anchor">#</a> The Series so Far</h4> <p>At Build 2018, we first saw the <a href="http://aka.ms/button?WT.mc_id=akams-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">IoT Button<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. I started <a href="https://www.youtube.com/watch?v=OdGHWwRBf_c?WT.mc_id=youtube-azuredevtips-micrum" target="_blank" rel="noopener noreferrer">exploring the device<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> with the very first unboxing and decided to create a mini-series to walk you how to use the device from start to finish. The series (so far) is located below</p> <ul><li><a href="https://microsoft.github.io/AzureTipsAndTricks/blog/tip122.html" target="_blank" rel="noopener noreferrer">Creating an IoT for the IoT Button<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://microsoft.github.io/AzureTipsAndTricks/blog/tip123.html" target="_blank" rel="noopener noreferrer">Configuring and Setting up the IoT Button<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://microsoft.github.io/AzureTipsAndTricks/blog/tip124.html" target="_blank" rel="noopener noreferrer">Creating the Azure Logic App for our IoT Button<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://microsoft.github.io/AzureTipsAndTricks/blog/tip125.html" target="_blank" rel="noopener noreferrer">Using Azure Function to call our Logic App with the IoT Button<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>We know how to setup an IoT Hub and configure our device to get on the network, we've worked with Logic Apps that will automatically add a row to an excel sheet that includes a time along with a status (such as start or stop). All that is left is to add an Azure Function that calls the Logic Apps and passes a parameter.</p> <h4 id="using-azure-function-to-call-our-logic-app-with-the-iot-button"><a href="#using-azure-function-to-call-our-logic-app-with-the-iot-button" aria-hidden="true" class="header-anchor">#</a> Using Azure Function to call our Logic App with the IoT Button</h4> <p>Open Visual Studio and click on <strong>Cloud</strong> and then <strong>Azure Functions</strong> and give it a name and click OK.</p> <img src="/AzureTipsAndTricks/files/iotbutton22.png"> <p>We'll begin with an <strong>Empty</strong> project type and <strong>Azure Function v2</strong>. You can leave the Storage Account as the emulator. We won't need it.</p> <img src="/AzureTipsAndTricks/files/iotbutton23.png"> <p>After your project is loaded, we need to add an item. So right click the project and select <strong>Add new item</strong> and select <strong>Azure Functions</strong> and give it a name and click Add.</p> <img src="/AzureTipsAndTricks/files/iotbutton24.png"> <p>Make sure you select <strong>IoT Hub trigger</strong>.</p> <img src="/AzureTipsAndTricks/files/iotbutton25.png"> <p>For the Connection string, give it the name <strong>IoTHubConnectionString</strong> and leave the <strong>Path</strong> as-is and click OK.</p> <p>Once your project settles down, go into your <code>local.settings.json</code> and add the following placeholder for our connection string (which will be used shortly:</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;IsEncrypted&quot;: false,
  &quot;Values&quot;: {
    &quot;AzureWebJobsStorage&quot;: &quot;UseDevelopmentStorage=true&quot;,
    &quot;AzureWebJobsDashboard&quot;: &quot;UseDevelopmentStorage=true&quot;,
    &quot;IoTHubConnectionString&quot;: &quot;&quot;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Go into the IoT Hub that you created, select Built-in endpoints, and copy the <strong>Event Hub-compatible endpoint</strong> to notepad somewhere.</p> <img src="/AzureTipsAndTricks/files/iotbutton28.png"> <p>For example mine is <code>Endpoint=sb://xxxservicebus.windows.net/;SharedAccessKeyName=xxx=;EntityPath=myioteventhubcompatiblename</code>. Now copy that into the <strong>IoTHubConnectionString</strong> field in our  <code>local.settings.json</code>.</p> <p>If you run the application now, you'll see our function can accept messages. So go ahead and press your IoT Button and you should see something return.</p> <img src="/AzureTipsAndTricks/files/iotbutton26.png"> <p>Now in order for our app to use the Logic App, we need to write some code, but remember how we added a <strong>status</strong> field that the Logic App is looking for?</p> <p>We'll first use create a file that will store the value either <strong>Started</strong> or <strong>Stopped</strong> and save that on the local machine or published app service site. We'll create a quick helper method that will toggle the fields every time the function runs.</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> persistedCount <span class="token operator">=</span> <span class="token function">LoadCurrentStatus</span><span class="token punctuation">(</span><span class="token string">&quot;status.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;Status is &quot;</span> <span class="token operator">+</span> persistedCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">string</span> <span class="token function">LoadCurrentStatus</span><span class="token punctuation">(</span><span class="token keyword">string</span> fileName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>

    <span class="token keyword">var</span> folder <span class="token operator">=</span> Environment<span class="token punctuation">.</span><span class="token function">ExpandEnvironmentVariables</span><span class="token punctuation">(</span><span class="token string">@&quot;%HOME%\data\AzureFunctionAppData&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> fullPath <span class="token operator">=</span> Path<span class="token punctuation">.</span><span class="token function">Combine</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span>folder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">string</span> persistedState <span class="token operator">=</span> <span class="token string">&quot;Start&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>fullPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        persistedState <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">ReadAllText</span><span class="token punctuation">(</span>fullPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>persistedState <span class="token operator">==</span> <span class="token string">&quot;Start&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            persistedState <span class="token operator">=</span> <span class="token string">&quot;Stop&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>persistedState <span class="token operator">==</span> <span class="token string">&quot;Stop&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            persistedState <span class="token operator">=</span> <span class="token string">&quot;Start&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    File<span class="token punctuation">.</span><span class="token function">WriteAllText</span><span class="token punctuation">(</span>fullPath<span class="token punctuation">,</span> persistedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> persistedState<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>Now we need to send the status to our Logic App. We'll use <strong>Newtonsoft.Json</strong> by pulling in the proper NuGet package.</p> <img src="/AzureTipsAndTricks/files/iotbutton27.png"> <p>And we'll add the following <strong>status</strong> code to be serialized as a class:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyStatus</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">string</span> status <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>We'll initialize the field with the current status as indicated on our file system and then set the header and call our Azure Logic App url which can be copied in the Logic App Designer after you save it.</p> <img src="/AzureTipsAndTricks/files/iotbutton29.png"> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> myContent <span class="token operator">=</span> JsonConvert<span class="token punctuation">.</span><span class="token function">SerializeObject</span><span class="token punctuation">(</span>myStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> buffer <span class="token operator">=</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Encoding<span class="token punctuation">.</span>UTF8<span class="token punctuation">.</span><span class="token function">GetBytes</span><span class="token punctuation">(</span>myContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> byteContent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayContent</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
byteContent<span class="token punctuation">.</span>Headers<span class="token punctuation">.</span>ContentType <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaTypeHeaderValue</span><span class="token punctuation">(</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">PostAsync</span><span class="token punctuation">(</span><span class="token string">&quot;https://xxx.westus.logic.azure.com:443/workflows/xxx/triggers/manual/paths/invoke?api-version=2016-10-01&amp;sp=%2Ftriggers%2Fmanual%2Frun&amp;sv=1.0&amp;sig=xxx&quot;</span><span class="token punctuation">,</span> byteContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Now if we run the Azure Function (either locally or published) and press our IoT Button, then it will call the Logic App and finally insert a Start (or Stop) status along with the DateTime in our Excel workbook.</p> <p>In the sample below, I'll use the <a href="https://prodiotsimulator.blob.core.windows.net/site/index.html" target="_blank" rel="noopener noreferrer">IoT Button Simulator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to paste in my Connection String, which my Azure Function will process and it will call my Logic App which writes an entry to my table in MS Excel. Very cool!</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/-EWIbX_DfF0?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen="allowfullscreen"></iframe></div> <div class="page-edit" data-v-0e4468e2><div class="edit-link" data-v-0e4468e2><a href="https://github.com/microsoft/azuretipsandtricks/edit/master/blog/tip125.md" target="_blank" rel="noopener noreferrer" data-v-0e4468e2>Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-0e4468e2 data-v-0e4468e2><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <section class="share" data-v-0e4468e2><h2 data-v-0e4468e2>Share</h2> <a href="https://twitter.com/intent/tweet?text=Tip 125 - Using Azure Function to call our Logic App with the IoT Button by @mbcrump http://azuredev.tips/blog/tip125.html" target="_blank" class="share__button" data-v-0e4468e2><i class="fab fa-twitter" data-v-0e4468e2></i> Tweet
    </a></section></div> <!----></div> <div class="page-nav" data-v-0e4468e2><p class="inner" data-v-0e4468e2><span class="prev" data-v-0e4468e2>
        ←
        <a href="/AzureTipsAndTricks/blog/tip124.html" class="prev" data-v-0e4468e2>
          Tip 124 - Creating the Azure Logic App for our IoT Button
        </a></span> <span class="next" data-v-0e4468e2><a href="/AzureTipsAndTricks/blog/tip126.html" data-v-0e4468e2>
          Tip 126 - Getting Started with Azure IoT Central
        </a>
        →
      </span></p></div> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/AzureTipsAndTricks/assets/js/app.c3e71ca2.js" defer></script><script src="/AzureTipsAndTricks/assets/js/4.1e17da4f.js" defer></script><script src="/AzureTipsAndTricks/assets/js/36.3c05d0f1.js" defer></script>
  </body>
</html>
